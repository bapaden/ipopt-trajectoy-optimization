TODO:

1) trajectories.h and math_utils.h have a lot of unnecessary copying
